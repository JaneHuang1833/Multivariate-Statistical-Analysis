---
title: "模型拟合"
output: html_notebook
---

## 二）模型拟合

本部分使用R软件进行操作：

通过上述分析，最终选取变量$X_1,X_2,X_3,X_6,X_9,X_{14}$ 构建回归模型：

$$
Y = \beta_{0}    + \beta_{1}X_{1}    + \beta_{2}X_{2}    + \beta_{3}X_{3}    + \beta_{6}X_{6}    + \beta_{9}X_{9}    + \beta_{14}X_{14}    + \varepsilon ,\quad \varepsilon \sim N(0,\sigma^{2})
$$

其中，

-   $X_1$ ：年平均降水量（英寸）

-   $X_2$ ：一月份平均气温（华氏度）

-   $X_3$ ：七月份平均气温（华氏度）

-   $X_6$ ： 接受学校教育年限的中位数

-   $X_9$ ：非白种人的百分比

-   $X_{14}$ ：二氧化硫相对潜在污染

利用最小二乘法拟合上述模型，结果如下：

```{r}
# 拟合最终模型
model_final <- lm(Y ~ X1 + X2 + X3 + X6 + X9 + X14 ,
            data = a)

summary(model_final)
```

\begin{table}[H]
\centering
\begin{threeparttable}
\caption{最终模型的回归系数估计结果}
\renewcommand{\arraystretch}{1.18}
\begin{tabular}{lrrrr}
\toprule
变量 & 估计值 & 标准误& t 值 & p 值 \\
\midrule
(截距) & 1180.34940 & 120.45361 &  9.799 & 1.7e-13*** \\
X1     &    1.79699 &   0.59897 &  3.000 & 0.00411**  \\
X2     &   -1.48358 &   0.51364 & -2.888 & 0.00560**  \\
X3     &   -2.35518 &   1.24396 & -1.893 & 0.06378.   \\
X6     &  -13.61939 &   6.43204 & -2.117 & 0.03893*   \\
X9     &    4.58527 &   0.69630 &  6.585 & 2.1e-08*** \\
X14    &    0.25962 &   0.07837 &  3.313 & 0.00167**  \\
\bottomrule
\end{tabular}

\begin{tablenotes}
\footnotesize
\item 残差标准误：33.8（自由度 53）
\item 决定系数：R$^{2}$ = 0.7348；调整后 R$^{2}$ = 0.7048
\item F 统计量：24.48（6 与 53 自由度），p 值 = 1.149e-13
\end{tablenotes}

\end{threeparttable}
\end{table}

### 1、回归系数解释与变量显著性检验

*注：带入回归模型的观测变量是经过标准化的，而响应变量是原始量纲。因此，回归系数的含义为：**在控制其他变量不变的情况下，X每增加一个标准差，死亡率增加的平均数值**。*

由于各变量的系数对应的是标准化后的变量对因变量的影响，不受量纲影响，因此可直接比较得到各变量的相对影响程度。由表中结果可知，受教育年限中位数$X_6$的系数最大，说明受教育年限是对死亡率的影响最大，二氧化硫相对潜在污染$X_{14}$ 的影响最小，具体说明如下：

1.  截距项

    **截距项**的参数估计为1180.35，p值\<0.001；在所有解释变量都取 0 时的预测死亡率约为 1180。但由于 0 英寸降水、0°F 气温等在现实中并不一定落在样本范围内，截距主要起到调整整体水平的作用，其实际解释意义有限。

2.  气候变量

    **年平均降水量**$X_1$ 的系数估计为1.797，p值为0.0041，较为显著。在控制气温、教育水平、种族结构和污染水平不变的情况下，**年平均降水量每增加 1 个标准差，地区的死亡率平均增加约 1.80 个单位**。**降水增加带来的死亡率增加**，可能是因为湿度大有利于细菌繁殖，某些传染病或呼吸系统疾病流行更多。

    **一月份平均气温（冬季气温）**$X_2$ 的系数估计为-1.484，p值为0.005，较为显著。在其他变量相同的条件下，一月份平均气温每升高 1个标准差，死亡率平均降低约 1.48 个单位。统计上显著为负，说明**冬季越温暖的地区，死亡率越低**。严寒会增加心血管疾病和呼吸系统疾病风险，较高的冬季气温有利于减少因寒冷导致的死亡。

    **七月份平均气温（夏季气温）**$X_3$ 的系数估计为-2.355，p值为0.06，呈现出负向趋势，但统计显著性较弱（由上述变量筛选部分从模型性能角度看，此变量不能被删除）。这可能反映出夏季气温与死亡率之间的关系比较复杂：一方面，高温会增加中暑和某些疾病的风险，或是高温加速食物变质，易引发饮食不当而导致的肠道疾病；另一方面，高温可杀死细菌，减少疾病传播。可见，对七月平均气温的影响不能单从回归结果分析，应从其他角度加以进一步分析。

3.  社会经济与人口结构变量

    **受教育年限中位数**$X_6$ 的参数估计为-13.619，p值为0.039，较为显著。在控制气候、种族构成和污染水平后，**受学校教育年限的中位数每增加 1个标准差，死亡率平均降低约 13.6 个单位。**这是一个典型的社会经济指标：教育水平的提高通常与健康知识、卫生习惯、就业与收入状况、医疗服务使用能力等一系列改善相联系。因此，教育水平较高的地区往往具有更低的死亡率。

    **非白种人百分比**$X_9$ 的估计参数为4.585，p值为2.1e-08，非常显著。**在控制气候、教育和 污染后，非白种人比例每增加 1 个标准差，死亡率平均增加约 4.59 个单位**。这是所有变量中 t 值绝对值最大的一个，统计显著性极高。从人口健康研究的视角，这一结果反映了显著的种族健康差异：非白人比例较高的地区，死亡率显著偏高。这可能与多重社会结构性因素相关，如收入差距、职业类型、居住环境、医疗服务可及性、制度性歧视等。

4.  环境污染

    **二氧化硫相对潜在污染**$X_{14}$ 估计系数为0.260，p值为0.002，较为显著。**在其他条件不变时，二氧化硫潜在污染指标每增加 1 个标准差，死亡率平均增加约 0.26 个单位。**这与大量流行病学研究的结论一致：二氧化硫等空气污染物可增加呼吸系统和心血管疾病的发病与死亡风险。该变量提供了重要的环境健康证据，是模型中解释死亡率的关键因素之一。

**需要注意的是，模型发现的是地区层面的统计相关性，并不能简单地理解为变量本身导致死亡率提高**，**而更可能是种族与社会经济、制度因素共同作用的综合结果。**

### 2、回归模型整体显著性检验

方差分析结果如下：

```{r}

# 提取 ANOVA 表
anova_raw <- anova(model_final)

# 样本量
n <- nrow(a)

# 回归自由度
k <- length(model_final$coefficients) - 1

# 计算各项
SSR <- sum(anova_raw$"Sum Sq"[1:k])
SSE <- anova_raw$"Sum Sq"[k+1]
SST <- SSR + SSE

MSR <- SSR / k
MSE <- SSE / (n - k - 1)

F_value <- MSR / MSE
p_value <- pf(F_value, k, n - k - 1, lower.tail = FALSE)


anova_table <- data.frame(
  Source = c("回归（模型）", "残差（误差）", "总和"),
  SS = c(SSR, SSE, SST),
  df = c(k, n - k - 1, n - 1),
  MS = c(MSR, MSE, NA),
  F = c(F_value, NA, NA),
  `p-value` = c(p_value, NA, NA)
)

anova_table

```

\begin{table}[htbp]
\centering
\caption{回归模型的方差分析表}
\label{tab:anova}
\begin{tabular}{lrrrrr}
\toprule
\textbf{} & \textbf{平方和} & \textbf{自由度} & \textbf{均方} & \textbf{F值} & \textbf{p值} \\
\midrule
回归 & 167770.4 & 6  & 27961.739 & 24.47914 & $1.15\times10^{-13}$ \\
残差 & 60540.2  & 53 & 1142.268  & --        & -- \\
总和          & 228310.6 & 59 & --        & --        & -- \\
\bottomrule
\end{tabular}
\end{table}

从模型整体拟合效果来看：

1.  $R^2$=0.7348，修正后的$R^2$=0.7048：说明约 73% 的死亡率变异可以由这 6 个自变量解释，调整后仍有 70%，拟合度较好;

2.  F 统计量 = 24.48（大于该自由度下的临界值3.7），p值=1.149e−13：整体回归显著，至少有一个解释变量对死亡率有显著线性影响。

可见，模型整体的拟合效果较好。
